<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#4078c0;text-decoration:none;}a:hover,a:active{text-decoration:underline;}ol, ul{margin-left:16px;}</style><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><title data-react-helmet="true"></title><meta data-react-helmet="true" name="description" content="A documentation site for Another C Library."/><meta data-react-helmet="true" property="og:title" content=""/><meta data-react-helmet="true" property="og:description" content="A documentation site for Another C Library."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Daniel Curtis"/><meta data-react-helmet="true" name="twitter:title" content=""/><meta data-react-helmet="true" name="twitter:description" content="A documentation site for Another C Library."/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="shortcut icon" href="/icons/icon-48x48.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="generator" content="Gatsby 2.18.14"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=e7dae36d9f0cebf3ec80080daa0bd528"/><style data-href="/styles.66212a8dc2aa02e99aac.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}html{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif`}a{text-decoration:none;cursor:pointer;color:#3182ce}a:hover{text-decoration:none;-webkit-filter:brightness(80%);filter:brightness(80%)}a:hover,button:hover{-webkit-transition:.6s;transition:.6s}button:hover{-webkit-filter:brightness(115%);filter:brightness(115%)}nav{display:flex;align-items:center}li{margin-bottom:3px}:not(pre)>code[class*=language],pre[class*=language]{border-radius:0;background:#f6f8fa;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;text-shadow:none}:not(pre)>code[class*=language]{color:#000;padding:3px}code[class*=language-],pre,pre[class*=language-]{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;text-shadow:none}pre{background:#f6f8fa;font-size:.85rem;line-height:32px;overflow:scroll}.Footer{max-width:1200px;margin:30px auto;display:flex;justify-content:space-between}.Flex{display:grid;grid-template-columns:auto auto;grid-column-gap:50px}.Content{max-width:950px;width:72vw}@media only screen and (max-width:600px){.Footer,nav{flex-direction:column}.Flex{grid-template-columns:auto}.Sidebar{display:none}.Content{width:100%}}.Index-mn{max-width:1200px;margin:80px auto;padding:10px}.Index-hr{background-color:#2d3748;height:50vh;display:flex;align-items:center;text-align:center;margin:0 auto}.Index-h2{font-size:calc(16px + 2vw);margin:0 auto;color:#fff;border-bottom:none}.Index-h3{font-size:calc(16px + 1vw);color:#e2e8f0}.Index-p{color:#1a202c;list-style:none}.Index-hr-txt{text-align:center;margin:0 auto}.Index-cd{font-size:calc(16px + 1.5vw);background-color:#4a5568;padding:5px}.Index-btn{border-radius:10px;border:none;padding:10px 24px;margin:10px;font-size:18px;background:#3182ce;color:#fff;cursor:pointer}.Md-mn{margin:0 auto;max-width:1200px;display:flex}.Md-cntnt{color:#000;margin:0;padding:20px}.Md-actv-lnk{color:#38a169;font-weight:700}.Md-pst-ftr{display:flex;justify-content:space-between;border-top:1px solid #000;padding-top:10px}.Md-rrw{padding-top:5px}.Ebook-mn{margin:0 auto;max-width:1200px;display:flex}.Ebook-cntnt{color:#000;margin:0;padding:20px}.Ebook-sdbr{background:#f7fafc;width:20vw;height:100vh;padding:15px;color:#63b3ed;position:-webkit-sticky;position:sticky;top:62px}.License-mn{margin:0 auto;max-width:1200px;min-height:60vh;padding:50px 10px}.Footer-ctr{background-color:#1a202c;padding:10px;color:#fff}.Footer-ul{list-style:none;margin-left:0}.Footer-lnk{color:#3182ce}.Footer-p{margin-bottom:15px}</style><link as="script" rel="preload" href="/app-e58ca3d087e406b9103e.js"/><link as="script" rel="preload" href="/component---src-templates-md-page-js-203a2af8ece2db94eba8.js"/><link as="script" rel="preload" href="/styles-a8f8354e20700922ebe9.js"/><link as="script" rel="preload" href="/commons-e35ce588aa3e1cb27cb6.js"/><link as="script" rel="preload" href="/webpack-runtime-cf36343a7af8135e4c07.js"/><link as="fetch" rel="preload" href="/page-data/quicksort_improvement/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="background-color:white"><header style="position:sticky;top:0;background-color:#1A202C;z-index:1;color:white"><nav style="margin:auto;max-width:1200px"><a style="font-size:1.25rem;padding:1rem 1.5rem;font-family:-apple-system,&#x27;BlinkMacSystemFont&#x27;,&#x27;Segoe UI&#x27;,&#x27;Roboto&#x27;,&#x27;Oxygen&#x27;,&#x27;Ubuntu&#x27;,&#x27;Cantarell&#x27;,&#x27;Fira Sans&#x27;,&#x27;Droid Sans&#x27;,&#x27;Helvetica Neue&#x27;,sans-serif" href="/"><span style="font-weight:700">Another C Library</span></a><a style="font-size:1.25rem;padding:1rem 1.5rem;font-family:-apple-system,&#x27;BlinkMacSystemFont&#x27;,&#x27;Segoe UI&#x27;,&#x27;Roboto&#x27;,&#x27;Oxygen&#x27;,&#x27;Ubuntu&#x27;,&#x27;Cantarell&#x27;,&#x27;Fira Sans&#x27;,&#x27;Droid Sans&#x27;,&#x27;Helvetica Neue&#x27;,sans-serif" href="/docs/">Documentation</a><a style="font-size:1.25rem;padding:1rem 1.5rem;font-family:-apple-system,&#x27;BlinkMacSystemFont&#x27;,&#x27;Segoe UI&#x27;,&#x27;Roboto&#x27;,&#x27;Oxygen&#x27;,&#x27;Ubuntu&#x27;,&#x27;Cantarell&#x27;,&#x27;Fira Sans&#x27;,&#x27;Droid Sans&#x27;,&#x27;Helvetica Neue&#x27;,sans-serif" href="/ebook/">Learn C</a><a style="font-size:1.25rem;padding:1rem 1.5rem;font-family:-apple-system,&#x27;BlinkMacSystemFont&#x27;,&#x27;Segoe UI&#x27;,&#x27;Roboto&#x27;,&#x27;Oxygen&#x27;,&#x27;Ubuntu&#x27;,&#x27;Cantarell&#x27;,&#x27;Fira Sans&#x27;,&#x27;Droid Sans&#x27;,&#x27;Helvetica Neue&#x27;,sans-serif" target="_blank" rel="noopener noreferrer" href="https://github.com/contactandyc/another-c-library">Github <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" style="padding-top:5px" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M576 24v127.984c0 21.461-25.96 31.98-40.971 16.971l-35.707-35.709-243.523 243.523c-9.373 9.373-24.568 9.373-33.941 0l-22.627-22.627c-9.373-9.373-9.373-24.569 0-33.941L442.756 76.676l-35.703-35.705C391.982 25.9 402.656 0 424.024 0H552c13.255 0 24 10.745 24 24zM407.029 270.794l-16 16A23.999 23.999 0 0 0 384 303.765V448H64V128h264a24.003 24.003 0 0 0 16.97-7.029l16-16C376.089 89.851 365.381 64 344 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V287.764c0-21.382-25.852-32.09-40.971-16.97z"></path></svg></a><p style="margin:auto">Version 1.0</p></nav></header><main><div class="Md-mn"><div class="Md-cntnt Content"><h1></h1><p>Copyright <!-- -->2020<!-- --> Andy Curtis &amp; Daniel Curtis</p><div><h1 id="improving-quicksort"><a href="#improving-quicksort" aria-label="improving quicksort permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Improving Quicksort</h1>
<p>Quicksort is an extremely popular sorting algorithm developed by Tony Hoare. His basic intuition was that sorting a set of items could be done using a sequence of swaps around a pivot point. The pivot point would be used to divide the data such that all data less than or equal to the pivot would sit on one side and the rest of data would sit on the other side.  I've noticed an improvement that doesn't seem to be found in any of the implementations.  The idea is explored at the end (feel free to skip the basic description of quicksort if you know it).</p>
<blockquote>
<p>AFDBKDJE  </p>
</blockquote>
<p>For example, if the last item (E) was was chosen as the pivot amongst the set above. ADBD would be to the left of the pivot and FKJ would be to the right of the pivot.</p>
<blockquote>
<p>ADBD E FKJ</p>
</blockquote>
<p>We could then repeat the process of choosing the last item within each set (choose the smaller set first using J as the pivot and place F to the left and K to the right)</p>
<blockquote>
<p>ABDB E F J K</p>
</blockquote>
<p>Once a set has one item, the set is in its proper place. The only remaining part is ABDB and we will again choose the last item as the pivot.</p>
<blockquote>
<p>A B DB E F J K</p>
</blockquote>
<p>Finally, DB will be sorted by choosing B and then placing D to the right.</p>
<blockquote>
<p>A B B D E F J K</p>
</blockquote>
<p>Worst case scenarios and choosing a pivot</p>
<p>In the above example, the last item was chosen as the pivot. If the set was already sorted, it would yield the worst case scenario. Consider the following.</p>
<blockquote>
<p>ABCDE</p>
</blockquote>
<p>choose E as midpoint (ABCD compared against E)</p>
<blockquote>
<p>ABCD E</p>
</blockquote>
<p>choose D as midpoint (ABC compared against D)</p>
<blockquote>
<p>ABC D E</p>
</blockquote>
<p>choose C as midpoint (AB compared against C)</p>
<blockquote>
<p>AB C D E</p>
</blockquote>
<p>choose B as midpoint (A compared against B)</p>
<blockquote>
<p>A B C D E</p>
</blockquote>
<p>In this case, the sort would take 10 comparisons. Choosing the first point would yield a similar result. If the midpoint was chosen, then the sort worst of data being sorted would have been avoided.</p>
<blockquote>
<p>ABCDE</p>
</blockquote>
<p>choose C as midpoint (ABDE compared)</p>
<blockquote>
<p>AB C DE</p>
</blockquote>
<p>choose A as midpoint (mid of 2 choosing first, B compared)</p>
<blockquote>
<p>A B C DE</p>
</blockquote>
<p>choose D as midpoint (E compared)</p>
<blockquote>
<p>A B C D E</p>
</blockquote>
<p>By choosing the midpoint, it required one less pivot selection and the number of comparisons is limited to 6.  This still has a worst case where all items are equal.</p>
<blockquote>
<p>AAAAA</p>
</blockquote>
<p>choose midpoint A (compare AAAA)</p>
<blockquote>
<p>A AAAA</p>
</blockquote>
<p>choose midpoint A (compare AAA)</p>
<blockquote>
<p>A A AAA</p>
</blockquote>
<p>choose midpoint A (compare AA)</p>
<blockquote>
<p>A A A AA</p>
</blockquote>
<p>choose midpoint A (compare A)</p>
<blockquote>
<p>A A A A A</p>
</blockquote>
<p>The worst case scenario for the partitioning is when a single item is split off.  The best case scenario is when the partitioning equally splits the remaining items.  All items being equal is a common case.  It can be guarded against if it is noted that the pivot created two sets (one where all items were greater or equal and the other being the pivot itself).  In this case, compare the pivot to the next item and while they are equal, make the pivot set greater.  Since all of the items are equal, the pivot set doesn't need to be further sorted.</p>
<blockquote>
<p>AAAAA</p>
</blockquote>
<p>choose midpoint A (compare AAAA)</p>
<blockquote>
<p>A AAAA</p>
</blockquote>
<p>Notice that A is by itself and first.  Compare A to the next items until items are not equal (four more comparisons are done).</p>
<blockquote>
<p>AAAAA</p>
</blockquote>
<p>Choosing a midpoint of N items.</p>
<p>Robert Sedgewick proposed choosing a midpoint of 3 to 9 items.  The following example will choose the midpoint of 5 items from the original example.</p>
<blockquote>
<p>AFDBKDJE  </p>
</blockquote>
<p>The 5 items chosen are the first, the last, and 3 evenly spaced items in between (AFBDE).  To find the midpoint of 5 points, min-heapify the last 3 points and then only add the other two points if they are greater than the mid point.  If they are greater, swap the min value.</p>
<blockquote>
<p>BDE</p>
</blockquote>
<p>Then compare A against B, since A is less than B, do nothing.  </p>
<p>Compare F against B, since it is greater than B, swap B and push F onto the min-heap.</p>
<blockquote>
<p>A B FDE</p>
</blockquote>
<p>Becomes</p>
<blockquote>
<p>A B DEF</p>
</blockquote>
<p>The midpoint D is then used to do the split.  In the process of sorting the 5 elements, we actually have sorted some of the items in the original set.</p>
<blockquote>
<p>ABDDKEJF  </p>
</blockquote>
<p>We also know that AB and EF are to the left and the right of the pivot D, so we can move them into the first two places and the last two places.  In this case, B is already in the second place.  E and J will get swapped.</p>
<blockquote>
<p>ABDDKJEF</p>
</blockquote>
<p>The normal partitioning can continue with the middle DDKJ items as the AB and EF are already known.  We've chosen D as the pivot, so the end result is</p>
<blockquote>
<p>AB D DKJEF</p>
</blockquote>
<p>A couple of things to notice here.  Even though we chose the midpoint of 5, we didn't end up with great partitioning.  If the first, last, or mid was chosen it would have only been slightly worse.  In addition to this, we had to sort sparse items to find the median of 5.  If the 5 items chosen were all equal (and perhaps D), then there would be 2 Ds to the left of the pivot and 2 Ds to the right.  This is okay as the eventual sort will move the 2 Ds to the left to be next to the pivot (along with any other Ds).  The probability only slightly increases no matter which method is used.  The median of 3 or 5 does yield one slight advantage in that 2 or 3 items respectively will be partitioned off at each stage.</p>
<h2 id="an-important-intuition-to-quicksort"><a href="#an-important-intuition-to-quicksort" aria-label="an important intuition to quicksort permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>An important intuition to quicksort</h2>
<p>Quicksort performs best when data is randomized.  Having partially sorted data mixed into quicksort doesn't generally improve the overall performance of the algorithm.  Quicksort performs well when midpoints are chosen and it subsequently will often somewhat randomize perhaps previously partially sorted blocks.</p>
<h1 id="the-improvement-to-quicksort"><a href="#the-improvement-to-quicksort" aria-label="the improvement to quicksort permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Improvement to Quicksort</h1>
<p>The improvement that I've found is to consider Robert Sedgewick's choosing of the midpoint of N points.  During this process, one can know by the lack of reshuffling that the set of N points is in order (or in reverse order).  If it is known that the set of N points is in order and N is sufficiently large (perhaps 5-9 points), then you can check the original set to see if the set itself was in order.  The larger N is, the less likely that the set would randomly be in order.  If one were to consider the likelihood of 5 randomly or spatially selected points being in order and the data not being in order, one would only check the order less than 2% of the time.  If the number of points is increased to 9, then the order would only need to be checked less than 0.01% of the time.   This should only be applied on the first iteration of partitioning as it is highly likely that the input to the sort is already sorted, all equal, or reversed.  It is very unlikely that a sub-partition is both sorted and in the right place.  Consider the following example.</p>
<blockquote>
<p>ABCDEFGHIJKLMNOQPRSTUVWXYZ</p>
</blockquote>
<p>If 5 points are initially chosen AGNTZ.  During the heapify and selection of the midpoint, nothing would be changed.  Given that, compare the sequence in order to determine that the data is actually sorted.  If the set didn't have P and Q swapped and the items were in order, the order test would have been all that is needed to see that the data is sorted.  If the whole set was equal, this optimization would have also worked.</p>
<p>It is possible that the data isn't sorted (even if the 5 points are sorted) as in the example above where Q and P are swapped.  I'd suggest to make P the pivot and continue with the process as it is known that every point before the first case of data being out of order is less than the pivot.  If the data was out of order early (before the midpoint), then compare the midpoint and item that was out of order.  If the midpoint is less than the out of order element, swap the out of order element with the midpoint and continue with the process.</p>
<p>The second optimization is to consider the first and the last point.  If the first and the last point are reversed, consider reversing the comparisons to check that all 5 of the items are exactly reversed.  If they are reversed, then compare the set in exactly the same manner, except compare from the right backwards.  If all items are in reverse order do the standard reverse swapping method (swapping first and last towards the middle).  </p>
<p>If items are not sorted, the simplest option is to order the 5 points in the correct order, choose the midpoint, and continue with the normal sort.  Obviously, 5 points is somewhat arbitrary.  The more points that are initially chosen, the less likely the data will be falsely assumed to be in order.  However, even the cost of the check is largely mitigated in that a new pivot can be chosen.  A more complex solution might consider where the out of order element was found and continue with that pivot.</p>
<p>I've been writing an open source book (which is very much in its infancy) to explore algorithms and C found at <a href="https://github.com/contactandyc/another-c-library">https://github.com/contactandyc/another-c-library</a>  Part of the demo, illustrates the timing as it relates to this improvement.  In general, this algorithm only takes steps forward with very little extra cost.  The timings from the demo are shown below.</p>
<p>My sort is called ac_sort (another c sort).  It uses a combination of algorithms internally (particularly for sets of items which are 5 or less, the sort is hard-coded).  The core of the sorting algorithm is based upon works by Roger Sedgewick with the improvement mentioned above.</p>
<p>ac_sort</p>
<ul>
<li>random - 312,257 nanoseconds</li>
<li>already sorted - 17,007 nanoseconds</li>
<li>reversed - 17,722 nanoseconds</li>
</ul>
<p>The regular qsort</p>
<ul>
<li>random - 315,232 nanoseconds</li>
<li>already sorted - 201,070 nanoseconds</li>
<li>reversed - 199,330 nanoseconds</li>
</ul>
<p>The demo directory has a tool called quicksort_demo which shows the following results when sorting 64 bit integers.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">./quicksort_demo A 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
Manual test...
system qsort: 120.657ns
ac_sort: 16.636ns

./quicksort_demo A 1000
Ordered test...
system qsort: 4055.900ns
ac_sort: 561.300ns
Equal test...
system qsort: 2545.000ns
ac_sort: 488.800ns
Reverse test...
system qsort: 21440.100ns
ac_sort: 719.900ns
Slightly out of ordered test1...
system qsort: 3945.300ns
ac_sort: 4836.600ns
Slightly out of ordered test2...
system qsort: 4023.900ns
ac_sort: 4843.000ns
Random test...
system qsort: 55226.700ns
ac_sort: 9078.500ns</code></pre></div>
<p>I've run many different tests and compared it with various implementations of quicksort (including the C++ sort) and found that the improvement is better across the board.  In some cases, the C++ sort is more efficient than ac_sort and vice-versa for unsorted data.  I hope that this improvement can be adopted by the different implementations of quicksort!  Please share if you like this improvement to an almost 80 year old algorithm.</p>
<p>I'm working on a detailed explanation of how the ac_sort algorithm works and will publish it soon!</p>
<p><a href="../../../README.md">Table of Contents</a>  - Copyright 2019 Andy Curtis</p></div><div class="Md-pst-ftr"><a href="/null/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="Md-rrw" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zm116-292H256v-70.9c0-10.7-13-16.1-20.5-8.5L121.2 247.5c-4.7 4.7-4.7 12.2 0 16.9l114.3 114.9c7.6 7.6 20.5 2.2 20.5-8.5V300h116c6.6 0 12-5.4 12-12v-64c0-6.6-5.4-12-12-12z"></path></svg> <!-- -->Home</a><a href="/null/">Home<!-- --> <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="Md-rrw" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zM140 300h116v70.9c0 10.7 13 16.1 20.5 8.5l114.3-114.9c4.7-4.7 4.7-12.2 0-16.9l-114.3-115c-7.6-7.6-20.5-2.2-20.5 8.5V212H140c-6.6 0-12 5.4-12 12v64c0 6.6 5.4 12 12 12z"></path></svg></a></div></div><div style="font-family:-apple-system,&#x27;BlinkMacSystemFont&#x27;,&#x27;Segoe UI&#x27;,&#x27;Roboto&#x27;,&#x27;Oxygen&#x27;,
      &#x27;Ubuntu&#x27;,&#x27;Cantarell&#x27;,&#x27;Fira Sans&#x27;,&#x27;Droid Sans&#x27;,&#x27;Helvetica Neue&#x27;,sans-serif;height:100vh;padding:15px;color:#1E4E8C;position:sticky;top:62px;border-left:solid 1px #EDF2F7" class="Sidebar"><div></div></div></div></main><footer class="Footer-ctr"><div class="Footer"><div><h1 style="margin:10px 0">Another C Library</h1><p class="Footer-p">© <!-- -->2020<!-- --> Andy Curtis &amp; Daniel Curtis</p><ul class="Footer-ul"><li><a class="Footer-lnk" href="/contact">Contact</a></li><li><a class="Footer-lnk" href="/contributing">Contributing</a></li><li><a class="Footer-lnk" href="/license">License</a></li></ul></div><div><h2 style="margin:10px auto">Learn C</h2><ul class="Footer-ul"><li><a href="/ebook/1-getting-started">1. Getting Started</a></li><li><a href="/ebook/2-timing">2. Timing Your Code</a></li><li><a href="/ebook/3-buffer">3. The Buffer Object</a></li><li><a href="/ebook/4-linked-lists">4. Linked Lists</a></li><li><a href="/ebook/5-threads">5. Introducing Threads</a></li><li><a href="/ebook/6-macros">6. Macros</a></li><li><a href="/ebook/7-allocator">7. The Global Allocator Object</a></li><li><a href="/ebook/8-allocator-implementation">8. The Global Allocator Implementation</a></li><li><a href="/ebook/9-pool">9. The Pool Object</a></li><li><a href="/ebook/10-binary-search-trees">10. Binary Search Trees</a></li><li><a href="/ebook/11-balancing-binary-search-trees">11. Balancing Binary Search Trees</a></li><li><a href="/ebook/12-red-black-tree">12. The Red-Black Tree</a></li><li><a href="/ebook/13-map">13. The Map Object</a></li><li><a href="/ebook/14-set-and-multimap">14. The Set and Multimap</a></li></ul></div><div><div><h2 style="margin:10px auto">Documentation</h2><ul class="Footer-ul"><li><a href="/docs/ac-allocator">ac_allocator</a></li><li><a href="/docs/ac-pool">ac_pool</a></li></ul></div><h2 style="margin:10px auto">Resources</h2><ul class="Footer-ul"><li><a href="https://medium.com/software-design/why-software-developers-should-care-about-cpu-caches-8da04355bb8a" target="_blank" rel="noopener noreferrer" class="Footer-lnk">Why software developers should care about CPU caches <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M576 24v127.984c0 21.461-25.96 31.98-40.971 16.971l-35.707-35.709-243.523 243.523c-9.373 9.373-24.568 9.373-33.941 0l-22.627-22.627c-9.373-9.373-9.373-24.569 0-33.941L442.756 76.676l-35.703-35.705C391.982 25.9 402.656 0 424.024 0H552c13.255 0 24 10.745 24 24zM407.029 270.794l-16 16A23.999 23.999 0 0 0 384 303.765V448H64V128h264a24.003 24.003 0 0 0 16.97-7.029l16-16C376.089 89.851 365.381 64 344 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V287.764c0-21.382-25.852-32.09-40.971-16.97z"></path></svg></a></li><li><a href="https://github.com/contactandyc/another-c-library/blob/master/docs/tips.md#create-multiline-macro-in-c" target="_blank" rel="noopener noreferrer" class="Footer-lnk">Helpful Tips for Formatting <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M576 24v127.984c0 21.461-25.96 31.98-40.971 16.971l-35.707-35.709-243.523 243.523c-9.373 9.373-24.568 9.373-33.941 0l-22.627-22.627c-9.373-9.373-9.373-24.569 0-33.941L442.756 76.676l-35.703-35.705C391.982 25.9 402.656 0 424.024 0H552c13.255 0 24 10.745 24 24zM407.029 270.794l-16 16A23.999 23.999 0 0 0 384 303.765V448H64V128h264a24.003 24.003 0 0 0 16.97-7.029l16-16C376.089 89.851 365.381 64 344 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V287.764c0-21.382-25.852-32.09-40.971-16.97z"></path></svg></a></li><li><a href="https://mitpress.mit.edu/books/introduction-algorithms-third-edition" target="_blank" rel="noopener noreferrer" class="Footer-lnk">Introduction to Alogorithms <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M576 24v127.984c0 21.461-25.96 31.98-40.971 16.971l-35.707-35.709-243.523 243.523c-9.373 9.373-24.568 9.373-33.941 0l-22.627-22.627c-9.373-9.373-9.373-24.569 0-33.941L442.756 76.676l-35.703-35.705C391.982 25.9 402.656 0 424.024 0H552c13.255 0 24 10.745 24 24zM407.029 270.794l-16 16A23.999 23.999 0 0 0 384 303.765V448H64V128h264a24.003 24.003 0 0 0 16.97-7.029l16-16C376.089 89.851 365.381 64 344 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V287.764c0-21.382-25.852-32.09-40.971-16.97z"></path></svg></a></li></ul></div></div></footer></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/quicksort_improvement/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e58ca3d087e406b9103e.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-44b37c3d0621676eebb5.js"],"component---src-templates-md-page-js":["/component---src-templates-md-page-js-203a2af8ece2db94eba8.js"],"component---src-pages-404-js":["/component---src-pages-404-js-5e2ad222faf44acc28ff.js"],"component---src-pages-cards-js":["/component---src-pages-cards-js-4f7f83b47ce15ad24484.js"],"component---src-pages-contact-js":["/component---src-pages-contact-js-dd1d616c946bf818cddf.js"],"component---src-pages-contributing-js":["/component---src-pages-contributing-js-c395ff2a88d6c0887a23.js"],"component---src-pages-docs-js":["/component---src-pages-docs-js-5e463a823fa0254492be.js"],"component---src-pages-ebook-js":["/component---src-pages-ebook-js-21f13dc773f52113d145.js"],"component---src-pages-index-js":["/component---src-pages-index-js-256d509506fef9564ab4.js"],"component---src-pages-license-js":["/component---src-pages-license-js-97064b9e0f17f63a1129.js"]};/*]]>*/</script><script src="/webpack-runtime-cf36343a7af8135e4c07.js" async=""></script><script src="/commons-e35ce588aa3e1cb27cb6.js" async=""></script><script src="/styles-a8f8354e20700922ebe9.js" async=""></script><script src="/component---src-templates-md-page-js-203a2af8ece2db94eba8.js" async=""></script><script src="/app-e58ca3d087e406b9103e.js" async=""></script></body></html>